<script>

    var products = 
    [
      {
      "brand" : "Icy Blue Croc",
      "price" : 25.00,
      "image" : "images/blue_croc.jpg"
      },
      {
      "brand" : "Mint Green Croc",
      "price" : 25.00,
      "image" : "images/mint_croc.jpg"
      },
      {
      "brand" : "Croc Slides",
      "price" : 22.00,
      "image" : "images/slide_croc.jpg"
      },
      {
      "brand" : "Strappy Croc",
      "price" : 24.00,
      "image" : "images/strapped_croc.jpg"
      },
      {
      "brand" : "Tie-Dye Croc",
      "price" : 26.00,
      "image" : "images/tiedye_croc.jpg"
      }
  ];
    
</script>


<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="./products-style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Croc!</title>
</head>

<body>
    <form action="process_form" method = "POST">
        <h1>Brandy's Croc Store</h1>
    <div>
        <main>


<script>
    //Taken code from wod3. Allows us to use the array above to print out everything in it using only a for loop
    for(i = 0; i <= products.length; i++) {

    document.write(
    `<section class="item">
        <h2>${products[i].brand}</h2> 
        <p>$${products[i].price}</p> 
        <label>Quantity</label>
        <input type="text" placeholder="0" name ="quantity${i}" onkeyup = "checkQuantityTextbox(this);">
        <img src= ${products[i].image}>
    </section>      
    `);
    }
    
   // executes webpage
   window.onload = function () 
    {
        let params = (new URL(document.location)).searchParams; // this is to get the string that has the form data
        // if statement to figure out if we're good to go with no bad quantities
        if (params.has('submitPurchase'))
        {
            gotErrors = false; // just gonna set this to false from the start
            total_qty = 0; 
            // making loop to that lists the products
            for (i=0; i < products.length; i++)
            {
                if(params.has(`quantity${i}`))
                {
                    quantity = params.get(`quantity${i}`);
                    product_form[`quantity${i}`].value = quantity;
                    total_qty += quantity;
                    if (!isNonNegInt(quantity))
                    {
                        gotErrors = true;

                        // checks where an error is
                        checkQuantityTextbox(product_form[`quantity${i}`])
                    }
                }
            }
            if (gotErrors)
            {
                alert("Enter a valid quantity"); // for letting you know that the quantity value is invalid
            }
            else if (total_qty == 0)
            {
                alert("Your shopping cart is empty!"); // tells you have nothing in your cart
            }
            else
            {
                window.location = `./invoice.html${document.location.search}`; // the page will redirect you to the invoice
                window.stop
            }
        }
    }

</script>

        </main>
    </div>
    
    <footer>
        <br>
        <input type="submit" value = "Purchase!">
        <br>
        <p>There's a croc for every body!</p>

    </footer>
    
</body>

</html>